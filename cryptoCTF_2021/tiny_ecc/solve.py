from sage import *

p = 286838999562166707375553799215992552311
a = b = p * (2*p + 1)

P = (284410841827589586024045818028302776780,123031977792970737401667598280513508563)
kP = (15669530557558285974767588239522520043,129827752740402666038095482361202015345)
Q = (433145730361926699128676968052444082971,552455422950679540983313797027900692589)
lQ = (325312342653025849200620072404098229627,32594116380525481616094129737382733464)

J.<x> = GF(p)[]
f = x^3 + a*x + b

P = (GF(p)(P[0]), GF(p)(P[1]))
kP = (GF(p)(kP[0]), GF(p)(kP[1]))

mapP = P[0]*(P[1]^-1)
mapkP = kP[0]*(kP[1]^-1)

k = mapkP*(mapP^-1)
print(k)

p = 2 * p + 1

J.<x> = GF(p)[]
f = x^3 + a*x + b

Q = (GF(p)(Q[0]), GF(p)(Q[1]))
lQ = (GF(p)(lQ[0]), GF(p)(lQ[1]))

mapQ = Q[0]*(Q[1]^-1)
maplQ = lQ[0]*(lQ[1]^-1)

l = maplQ*(mapQ^-1)
print(l)
