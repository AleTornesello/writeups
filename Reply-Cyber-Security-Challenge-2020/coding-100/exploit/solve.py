import re

beginning_punctation = ['"', "'"]
end_punctation = [',', '.', '!', '?', '"', "'", ';', ":"]

dictionary = []
with open('words.txt', 'r') as file:
  for line in file:
    dictionary.append(line.strip())

first_lower = lambda str: str[:1].lower() + str[1:]
first_upper = lambda str: str[:1].upper() + str[1:]



def find_differences(word):
  while len(word) > 1 and word[-1] in end_punctation:
    word = word[:-1]

  while len(word) > 1 and word[0] in beginning_punctation:
    word = word[1:]

  if word.lower() in [x.lower() for x in dictionary]:
    return ''

  for d in dictionary:
    if len(d) == len(word):
      if word[0].islower():
        d = first_lower(d)
      else:
        d = first_upper(d)

      different_characters = ''
      for _ in range(len(word)):
        if d[_] != word[_]:
          different_characters += word[_]

      if len(different_characters) == 1:
        return different_characters
  
  return ''



with open('The Time Machine by H. G. Wells.txt','r') as file:   
    text = file.read().replace("\n", " ").replace('--', ' ').replace('  ', ' ')

    matches = re.findall(r'\{[^\{\}]*\}', text)
    for result in matches:
      differences = ''
      for word in result.split():
        differences += find_differences(word)
      print(differences)