from pwn import *
from decimal import Decimal, getcontext
from Crypto.Util.number import long_to_bytes
import random

getcontext().prec = 500

k = random.getrandbits(512)

start = 0
end = k
ans = 0

while True:
    conn = remote("crypto.be.ax",6000)
    for _  in range(64):
        conn.recvuntil("number> ")

        mid = int(Decimal(start+end)/Decimal(2))
        
        conn.sendline(str(mid))
        
        res = conn.recvline().decode().strip()
        
        if res == "1":
            end = mid - 1
        else:
            start = mid + 1
            ans = mid
    print(long_to_bytes(ans))
    conn.close()