import base64
from PIL import Image

im_original = Image.open('inject.png')
img = im_original.convert('RGB')

width, height = img.size

colours = [
    (255, 0, 0),
    (0, 0, 255),
    (0, 128, 0),
    (255, 255, 0)
]

bits = []
out = ''

for y in range(height):
    for x in range(width):
        r, g, b = img.getpixel((x,y))
        try:
            index = colours.index((r,g,b))
            bits.append(index)
        except:
            pass

for i in range(int(len(bits)/4)):
    c = 0
    c += (bits[i*4]<<6)
    c += (bits[i*4+1]<<4)
    c += (bits[i*4+2]<<2)
    c += (bits[i*4+3]<<0)

    out += chr(c)

print(out)
print(base64.b64decode(out))

with open("out", "wb") as fh:
    fh.write(base64.b64decode(out))