from pwn import *
from mt19937predictor import MT19937Predictor

conn = remote('challs.dvc.tf',3096)
print(conn.recvline())

numbers = []

for i in range(624):
    print(i)
    conn.sendline('3') # or any other value
    answer = conn.recvline().decode('ascii')
    split_answer = answer.split(' ')
    number = int(split_answer[12])
    numbers.append(number)
    print(number)

print(numbers)

predictor = MT19937Predictor()
for i in numbers:
    predictor.setrandbits(i,32)

guess = predictor.getrandbits(32)
print(type(guess))
print(guess)
conn.sendline(str(guess))
print(conn.recvline())