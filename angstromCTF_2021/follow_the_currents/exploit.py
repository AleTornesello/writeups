import zlib
from itertools import product

with open("dist/enc", "rb") as g:
    ciphertext = g.read()


def keystream(key):
    index = 0
    while 1:
        index += 1
        if index >= len(key):
            key += zlib.crc32(key).to_bytes(4, 'big')
        yield key[index]


def decrypt(keystream):
    plaintext = []
    for i in ciphertext:
        plaintext.append(i ^ next(keystream))
    return plaintext


for p in product(range(256), repeat=2):
    key = bytearray(p)

    k = keystream(key)
    plain = decrypt(k)

    plaintext = [chr(c) for c in plain]
    if "actf{" in "".join(plaintext):
        print("".join(plaintext))
